on:
    pull_request:
        tags:
            - 'v*.*'
        branches:
            - master
    push:
        tags:
            - 'v*.*'
        branches:
            - master
jobs:
    buildAndPushDocker:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v2
            - name: Set the tag as an env
              run: echo ::set-env name=RELEASE_VERSION::${GITHUB_REF:10}
            - name: Login to the docker registry of github packages
              run: echo ${{ secrets.LOGIN_TOKEN }} || docker login -u franusierra --password-stdin docker.pkg.github.com
            - name: Building the docker action and pushing to packages
              run: |
                docker build . --file Dockerfile --tag docker.pkg.github.com/franusierra/action-sample-sngular/hola-gente-actions:${{env.RELEASE_VERSION}}
                docker push docker.pkg.github.com/franusierra/action-sample-sngular/hola-gente-actions:${{env.RELEASE_VERSION}}
              